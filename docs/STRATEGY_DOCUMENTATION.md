# xCrack MEV Searcher Strategy Documentation

## Overview
xCrack은 4가지 핵심 전략을 통해 블록체인에서 수익 기회를 포착하는 MEV 서처입니다. 전략은 크게 두 가지 카테고리로 나뉩니다:
- **MEV 기반 전략**: 멤풀 모니터링을 통한 샌드위치, 청산
- **차익거래 전략**: 가격 차이를 활용한 마이크로 차익거래, 크로스체인 차익거래

## 1. Sandwich Strategy (샌드위치 전략)

### 1.1 데이터 소스
- **멤풀 모니터링**: 실시간 pending 트랜잭션 스트림
- **DEX 유동성 풀**: Uniswap V2/V3, SushiSwap, PancakeSwap 등의 현재 상태
- **가격 오라클**: 현재 토큰 가격 및 슬리피지 계산을 위한 외부 가격 데이터
- **가스 가격 네트워크**: 현재 가스 비용 및 우선순위 수수료 정보

### 1.2 데이터 처리 방식
- 멤풀에서 대규모 스왑 트랜잭션 감지 (임계값 이상의 거래량)
- 해당 트랜잭션이 가격에 미칠 영향 계산 (슬리피지 시뮬레이션)
- Front-run과 Back-run 트랜잭션의 수익성 분석
- 가스 비용 대비 예상 수익 계산
- 리스크 점수 평가 (MEV 경쟁, 실패 가능성 등)

### 1.3 데이터 저장 방식
- **기회 큐**: 발견된 샌드위치 기회를 우선순위 큐에 저장
- **실행 로그**: 시도한 샌드위치 공격의 결과 기록
- **성공률 메트릭**: DEX별, 토큰 페어별 성공률 추적
- **경쟁자 분석**: 다른 MEV 봇들의 패턴 및 전략 저장

### 1.4 비교 및 선택 로직
- 수익성 순위: 예상 수익에서 가스 비용을 뺀 순수익 기준
- 성공 확률: 과거 데이터 기반 성공률과 현재 네트워크 혼잡도 고려
- 경쟁 분석: 동일 기회를 노리는 다른 봇들의 존재 여부
- 리스크 임계값: 설정된 최대 손실 허용치 이내인지 확인

### 1.5 결과 수집 및 평가
- 트랜잭션 실행 결과 모니터링 (성공/실패/부분 성공)
- 실제 수익 vs 예상 수익 비교
- 가스 효율성 분석
- 타이밍 정확도 평가

### 1.6 평가 후 라우팅
- 성공 시: 수익 회수 및 재투자 전략 실행
- 실패 시: 실패 원인 분석 및 전략 파라미터 조정
- 부분 성공: 손익분기점 분석 및 최적화 포인트 도출

### 1.7 실행 대상
- **타겟 블록체인**: Ethereum, BSC, Polygon 등
- **타겟 DEX**: Uniswap, SushiSwap, PancakeSwap 등
- **타겟 트랜잭션**: 대규모 스왑, 유동성 추가/제거

### 1.8 실행 후 워크플로우
- 수익 정산 및 분배
- 성과 메트릭 업데이트
- 전략 파라미터 자동 조정
- 다음 기회 탐색으로 순환

## 2. Liquidation Strategy (청산 전략)

### 2.1 데이터 소스
- **DeFi 대출 프로토콜**: Aave, Compound, MakerDAO의 포지션 데이터
- **가격 오라클**: Chainlink, Band Protocol 등의 실시간 가격 피드
- **온체인 상태**: 각 프로토콜의 담보 비율 및 청산 임계값
- **멤풀 데이터**: 다른 청산봇들의 활동 모니터링

### 2.2 데이터 처리 방식
- 모든 활성 대출 포지션의 건전성 지수 실시간 계산
- 가격 변동에 따른 담보 비율 변화 추적
- 청산 가능 시점 예측 (가격 트렌드 분석)
- 청산 보상금 계산 및 수익성 평가
- 가스 전쟁 시나리오 시뮬레이션

### 2.3 데이터 저장 방식
- **포지션 데이터베이스**: 모든 추적 중인 대출 포지션 정보
- **가격 히스토리**: 청산 트리거 분석을 위한 가격 변동 기록
- **청산 이벤트 로그**: 과거 청산 성공/실패 케이스
- **경쟁 봇 프로파일**: 다른 청산봇들의 행동 패턴

### 2.4 비교 및 선택 로직
- 청산 보상금 크기 순위
- 청산 실행 난이도 (복잡도, 가스 비용)
- 경쟁 강도 평가 (다른 봇들의 관심도)
- 플래시론 필요 여부 및 비용

### 2.5 결과 수집 및 평가
- 청산 트랜잭션 성공 여부
- 획득한 보상금 vs 소요 비용
- 경쟁에서의 승률
- 타이밍 정확도 분석

### 2.6 평가 후 라우팅
- 성공 청산: 획득 자산 처리 (즉시 매도 또는 보유)
- 실패 청산: 실패 원인 분석 (늦은 실행, 높은 가스 등)
- 경쟁 패배: 전략 조정 (더 공격적인 가스 설정 등)

### 2.7 실행 대상
- **대출 프로토콜**: Aave, Compound, MakerDAO, Cream
- **담보 자산**: ETH, WBTC, 주요 스테이블코인
- **대출 자산**: DAI, USDC, USDT 등

### 2.8 실행 후 워크플로우
- 청산된 담보 자산 처리 결정
- DEX에서 최적 가격으로 매도
- 수익 실현 및 재투자
- 청산 전략 파라미터 업데이트

## 3. Micro Arbitrage Strategy (마이크로 차익거래 전략)

### 3.1 데이터 소스
- **다중 DEX 가격**: 동일 체인 내 모든 주요 DEX의 실시간 가격
- **유동성 데이터**: 각 풀의 TVL 및 거래 가능 수량
- **라우터 정보**: 최적 스왑 경로 계산을 위한 라우팅 데이터
- **가스 가격**: 현재 네트워크 가스 비용

### 3.2 데이터 처리 방식
- 모든 DEX 간 가격 차이 실시간 스캐닝
- 다중 홉 경로 포함한 차익거래 기회 계산
- 슬리피지 및 가격 영향 시뮬레이션
- 순수익 계산 (거래 수수료, 가스비 차감)
- 실행 시간 윈도우 추정

### 3.3 데이터 저장 방식
- **가격 매트릭스**: DEX별 토큰 페어 가격 테이블
- **차익거래 히스토리**: 과거 성공한 차익거래 패턴
- **경로 캐시**: 자주 사용되는 최적 거래 경로
- **DEX 통계**: 각 DEX의 신뢰도 및 성능 메트릭

### 3.4 비교 및 선택 로직
- 수익률 기준 정렬 (ROI 최대화)
- 실행 복잡도 평가 (단일 홉 vs 다중 홉)
- 유동성 충분성 확인
- 가격 변동성 리스크 평가

### 3.5 결과 수집 및 평가
- 실제 획득 수익 vs 예상 수익
- 슬리피지 실제 vs 예상
- 실행 속도 및 효율성
- 기회 소멸 시간 분석

### 3.6 평가 후 라우팅
- 수익 실현: 스테이블코인으로 전환
- 재투자: 다음 차익거래 기회 탐색
- 최적화: 더 효율적인 경로 발견

### 3.7 실행 대상
- **체인**: Ethereum, BSC, Polygon, Arbitrum
- **DEX**: Uniswap, SushiSwap, Curve, Balancer
- **토큰**: 고유동성 토큰 페어

### 3.8 실행 후 워크플로우
- 포지션 정리 및 수익 확정
- 가스 효율성 분석
- 다음 기회 즉시 스캔
- 성과 데이터 업데이트

## 4. Cross-Chain Arbitrage Strategy (크로스체인 차익거래 전략)

### 4.1 데이터 소스
- **다중 체인 가격**: 서로 다른 블록체인의 동일 토큰 가격
- **브리지 프로토콜**: 7개 브리지(Stargate, Hop, Rubic, Synapse, LiFi, Across, Multichain)의 견적
- **체인별 DEX**: 각 체인의 주요 DEX 가격 및 유동성
- **브리지 메트릭**: 처리 시간, 수수료, 성공률

### 4.2 데이터 처리 방식
- 모든 지원 체인 간 가격 차이 모니터링
- 브리지 비용 포함한 순수익 계산
- 브리지 처리 시간 동안의 가격 변동 리스크 평가
- 최적 브리지 프로토콜 선택 (비용, 속도, 신뢰도 기준)
- 양방향 차익거래 기회 분석

### 4.3 데이터 저장 방식
- **체인간 가격 테이블**: 실시간 가격 차이 매트릭스
- **브리지 성능 데이터**: 각 브리지의 역사적 성능 지표
- **성공 패턴**: 수익성 높은 체인 페어 및 토큰
- **리스크 프로파일**: 체인별, 브리지별 리스크 점수

### 4.4 비교 및 선택 로직
- **수익성 평가**: 가격 차이 - 브리지 비용 - 거래 수수료
- **시간 리스크**: 브리지 처리 시간 동안의 가격 변동 확률
- **브리지 선택**: RouteStrategy에 따른 최적 브리지 결정
  - LowestCost: 총 비용 최소화
  - FastestTime: 처리 시간 최소화
  - MostReliable: 성공률 최대화
  - Balanced: 균형잡힌 점수

### 4.5 결과 수집 및 평가
- 브리지 트랜잭션 상태 추적
- 최종 수익 실현 여부
- 예상 시간 vs 실제 처리 시간
- 슬리피지 및 가격 변동 영향

### 4.6 평가 후 라우팅
- 성공: 수익 회수 및 다음 기회 탐색
- 지연: 헤징 전략 실행 (가격 변동 대응)
- 실패: 브리지 신뢰도 점수 하향 조정

### 4.7 실행 대상
- **소스 체인**: Ethereum, Polygon, BSC, Arbitrum, Optimism, Avalanche
- **타겟 체인**: 가격 차이가 있는 모든 지원 체인
- **브리지**: 7개 통합 브리지 프로토콜
- **토큰**: USDC, USDT, WETH, WBTC 등 크로스체인 토큰

### 4.8 실행 후 워크플로우
- 브리지 완료 확인 및 자금 수령
- 타겟 체인에서 스왑 실행
- 수익 계산 및 보고
- 브리지 성능 메트릭 업데이트
- 다음 크로스체인 기회 스캔

## 전략 간 조정 및 우선순위

### 자본 할당
- 각 전략별 리스크 조정 수익률 기반 동적 할당
- 최소/최대 할당 한도 설정
- 시장 상황에 따른 전략 가중치 조정

### 우선순위 결정
1. **즉시 실행 필요**: 샌드위치, 청산 (시간 민감)
2. **단기 기회**: 마이크로 차익거래 (분 단위)
3. **중기 기회**: 크로스체인 차익거래 (시간 단위)

### 리스크 관리
- 전체 포트폴리오 최대 손실 한도
- 개별 거래 최대 리스크 설정
- 상관관계 분석을 통한 집중 리스크 방지

### 성과 추적
- 실시간 PnL 모니터링
- 전략별 성과 지표 대시보드
- 일/주/월 단위 성과 리포트
- 지속적인 전략 최적화 피드백 루프